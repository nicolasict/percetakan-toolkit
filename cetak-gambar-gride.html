<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Grid A4 Static Preset</title>

<style>
@page {
    size: A4 portrait;
    margin: 15mm;
}

body {
    font-family: Arial, sans-serif;
    margin: 0;
}

#controls {
    padding: 10px;
    background: #f2f2f2;
}

button {
    padding: 6px 12px;
    margin-right: 5px;
}

#grid-container {
    margin: 0;
}

.grid-page {
    width: 180mm;
    height: 267mm;
    display: grid;
    gap: 2mm;
    box-sizing: border-box;
}

.grid-item {
    position: relative;
    overflow: hidden;
    border: 1px solid #000;
}

.grid-item img {
    position: absolute;
    top: 50%;
    left: 50%;
    transform-origin: center center;
}

.zoom-control {
    position: absolute;
    bottom: 3mm;
    left: 50%;
    transform: translateX(-50%);
    width: 70%;
}

/* ================= PRINT ================= */
@media print {
    #controls {
        display: none;
    }
    .zoom-control {
        display: none !important; /* ⬅️ hide saat print */
    }
}
</style>
</head>

<body>

<div id="controls">
    <input type="file" id="fileInput" multiple accept="image/*">
    <button onclick="generate()">Generate</button>
    <button onclick="window.print()">Cetak</button>
</div>

<div id="grid-container"></div>

<script>
const gridContainer = document.getElementById('grid-container');
const fileInput = document.getElementById('fileInput');
let images = [];

/* PRESET LAYOUT STATIC */
const layouts = {
    2:  { cols: 1, rows: 2 },
    3:  { cols: 1, rows: 3 },
    4:  { cols: 2, rows: 2 },
    5:  { cols: 2, rows: 3 },
    6:  { cols: 2, rows: 3 },
    7:  { cols: 2, rows: 4 },
    8:  { cols: 2, rows: 4 },
    9:  { cols: 3, rows: 3 },
    10: { cols: 2, rows: 5 }
};

fileInput.addEventListener('change', e => {
    images = [];
    [...e.target.files].forEach(f => {
        const r = new FileReader();
        r.onload = ev => images.push(ev.target.result);
        r.readAsDataURL(f);
    });
});

function generate() {
    gridContainer.innerHTML = '';

    const count = images.length;
    if (!layouts[count]) {
        alert('Jumlah gambar tidak ada preset layout (2–10 gambar)');
        return;
    }

    const { cols, rows } = layouts[count];
    const totalBoxes = cols * rows;

    const page = document.createElement('div');
    page.className = 'grid-page';
    page.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
    page.style.gridTemplateRows = `repeat(${rows}, 1fr)`;

    for (let i = 0; i < totalBoxes; i++) {
        const item = document.createElement('div');
        item.className = 'grid-item';

        if (i < images.length) {
            const img = document.createElement('img');
            img.src = images[i];

            img.onload = () => {
                const bw = item.clientWidth;
                const bh = item.clientHeight;

                const scale = Math.max(
                    bw / img.naturalWidth,
                    bh / img.naturalHeight
                );

                img.dataset.base = scale;
                img.style.transform =
                    `translate(-50%, -50%) scale(${scale})`;
            };

            const zoom = document.createElement('input');
            zoom.type = 'range';
            zoom.min = 50;
            zoom.max = 200;
            zoom.value = 100;
            zoom.className = 'zoom-control';

            zoom.oninput = () => {
                const base = img.dataset.base;
                img.style.transform =
                    `translate(-50%, -50%) scale(${base * zoom.value/100})`;
            };

            item.appendChild(img);
            item.appendChild(zoom);
        }

        page.appendChild(item);
    }

    gridContainer.appendChild(page);
}
</script>

</body>
</html>
